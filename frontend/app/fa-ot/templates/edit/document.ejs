<div class="fa-edit-stage" data-stage="document">
  <%- helpers.props(details, [
    '!protocolNeeded',
    '!commissioningType',
    '!usageDestination',
    {id: '!protocolDate', visible: model.protocolNeeded},
    {id: 'protocolNo', visible: model.protocolNeeded, valueClassName: 'text-fixed'},
    {id: 'no', valueClassName: 'text-fixed'},
    {id: '!owner', visible: model.protocolNeeded},
    {id: '!committee', visible: model.protocolNeeded, value: function(users)
    {
      if (users.length === 0)
      {
        return '';
      }

      if (users.length === 1)
      {
        return users[0];
      }

      return '<ul>'
        + users.map(function(user) { return '<li>' + user; }).join('')
        + '</ul>';
    }},
    {id: '!protocolFile', visible: model.protocolNeeded, value: function(file)
    {
      return file
        ? ('<a href="' + details.url + '/attachments/protocol" target="_blank">' + _.escape(file.name) + '</a>')
        : t('FORM:edit:attachment:empty');
    }}
  ]) %>
  <div class="form-group fa-edit-short">
    <label for="<%- idPrefix %>-documentDate" class="control-label is-required"><%- t('PROPERTY:documentDate') %></label>
    <input id="<%- idPrefix %>-documentDate" name="documentDate" class="form-control" type="date" data-required>
  </div>
  <% if (model.commissioningType === 'inc-asset') { %>
  <div class="form-group fa-edit-short">
    <label for="<%- idPrefix %>-inventoryNo" class="control-label is-required"><%- t('PROPERTY:inventoryNo') %></label>
    <input id="<%- idPrefix %>-inventoryNo" name="inventoryNo" class="form-control" type="text" data-required>
  </div>
  <% } %>
  <div class="fa-edit-row fa-edit-long">
    <div class="form-group fa-edit-flex" style="margin-bottom: 15px">
      <label for="<%- idPrefix %>-assetName" class="control-label is-required"><%- t('PROPERTY:assetName') %></label>
      <input id="<%- idPrefix %>-assetName" name="assetName" class="form-control" type="text" data-required>
    </div>
    <% if (model.usageDestination === 'factory') { %>
    <div class="form-group fa-edit-short">
      <label for="<%- idPrefix %>-lineSymbol" class="control-label"><%- t('PROPERTY:lineSymbol') %></label>
      <input id="<%- idPrefix %>-lineSymbol" name="lineSymbol" class="form-control" type="text">
    </div>
    <% } %>
  </div>
  <div id="<%- idPrefix %>-zplx"></div>
  <div class="form-group fa-edit-long" style="margin-top: -10px">
    <label for="<%- idPrefix %>-supplier" class="control-label <%- model.commissioningType === 'new-asset' && model.usageDestination === 'external-supplier' ? '' : 'is-required' %>"><%- t('PROPERTY:supplier') %></label>
    <input id="<%- idPrefix %>-supplier" name="supplier" class="form-control" type="text" <%- model.commissioningType === 'new-asset' && model.usageDestination === 'external-supplier' ? '' : 'data-required' %>>
  </div>
  <div id="<%- idPrefix %>-value" style="margin-bottom: 15px"></div>
  <div class="fa-edit-row fa-edit-long">
    <div class="form-group fa-edit-short has-required-select2">
      <label for="<%- idPrefix %>-costCenter" class="control-label is-required"><%- t('PROPERTY:costCenter') %></label>
      <input id="<%- idPrefix %>-costCenter" name="costCenter" type="text" data-required>
    </div>
    <div class="form-group fa-edit-flex has-required-select2">
      <label for="<%- idPrefix %>-destination" class="control-label is-required"><%- t('PROPERTY:destination') %></label>
      <input id="<%- idPrefix %>-destination" name="destination" type="text" data-required>
    </div>
  </div>
  <% if (model.usageDestination === 'external-supplier') { %>
  <div class="fa-edit-row fa-edit-long">
    <div class="form-group fa-edit-short">
      <label for="<%- idPrefix %>-vendorNo" class="control-label is-required"><%- t('PROPERTY:vendorNo') %></label>
      <input id="<%- idPrefix %>-vendorNo" name="vendorNo" class="form-control" type="text" data-required>
    </div>
    <div class="form-group fa-edit-flex">
      <label for="<%- idPrefix %>-vendorName" class="control-label is-required"><%- t('PROPERTY:vendorName') %></label>
      <input id="<%- idPrefix %>-vendorName" name="vendorName" class="form-control" type="text" data-required>
    </div>
  </div>
  <% } %>
  <div class="form-group fa-edit-long">
    <label for="<%- idPrefix %>-checklistFile" class="control-label is-required"><%- t('PROPERTY:checklistFile') %></label>
    <table class="fa-edit-attachment">
      <tbody>
      <tr>
        <td class="is-min" style="padding: 0 10px 5px 0"><%- t('FORM:edit:attachment:old') %></td>
        <td style="padding-bottom: 5px">
          <% if (model.checklistFile) { %>
          <a href="/fa/ot/<%- model._id %>/attachments/checklist" target="_blank"><%= model.checklistFile.name %></a>
          <% } else { %>
          <%- t('FORM:edit:attachment:empty') %>
          <% } %>
        </td>
      </tr>
      <tr>
        <td class="is-min" style="padding-right: 10px"><%- t('FORM:edit:attachment:new') %></td>
        <td><input id="<%- idPrefix %>-checklistFile" name="checklistFile" class="form-control" type="file" <%- model.checklistFile ? '' : 'data-required' %>></td>
      </tr>
      </tbody>
    </table>
    <% if (model.usageDestination === 'factory' && model.checklistFile) { %>
    <p class="help-block"><%- t('FORM:edit:attachment:help') %></p>
    <% } %>
  </div>
  <% if (model.usageDestination === 'external-supplier') { %>
  <div class="form-group fa-edit-long">
    <label for="<%- idPrefix %>-certificateFile" class="control-label is-required"><%- t('PROPERTY:certificateFile') %></label>
    <table class="fa-edit-attachment">
      <tbody>
      <tr>
        <td class="is-min" style="padding: 0 10px 5px 0"><%- t('FORM:edit:attachment:old') %></td>
        <td style="padding-bottom: 5px">
          <% if (model.certificateFile) { %>
          <a href="/fa/ot/<%- model._id %>/attachments/certificate" target="_blank"><%= model.certificateFile.name %></a>
          <% } else { %>
          <%- t('FORM:edit:attachment:empty') %>
          <% } %>
        </td>
      </tr>
      <tr>
        <td class="is-min" style="padding-right: 10px"><%- t('FORM:edit:attachment:new') %></td>
        <td><input id="<%- idPrefix %>-certificateFile" name="certificateFile" class="form-control" type="file" <%- model.certificateFile ? '' : 'data-required' %>></td>
      </tr>
      </tbody>
    </table>
  </div>
  <div class="form-group fa-edit-long">
    <label for="<%- idPrefix %>-nameplateFile" class="control-label"><%- t('PROPERTY:nameplateFile') %></label>
    <table class="fa-edit-attachment">
      <tbody>
      <tr>
        <td class="is-min" style="padding: 0 10px 5px 0"><%- t('FORM:edit:attachment:old') %></td>
        <td style="padding-bottom: 5px">
          <% if (model.nameplateFile) { %>
          <a href="/fa/ot/<%- model._id %>/attachments/nameplate" target="_blank"><%= model.nameplateFile.name %></a>
          <% } else { %>
          <%- t('FORM:edit:attachment:empty') %>
          <% } %>
        </td>
      </tr>
      <tr>
        <td class="is-min" style="padding-right: 10px"><%- t('FORM:edit:attachment:new') %></td>
        <td><input id="<%- idPrefix %>-nameplateFile" name="nameplateFile" class="form-control" type="file"></td>
      </tr>
      </tbody>
    </table>
    <% if (model.checklistFile || model.certificateFile || model.nameplateFile) { %>
    <p class="help-block"><%- t('FORM:edit:attachment:help') %></p>
    <% } %>
  </div>
  <% } %>
  <% if (model.usageDestination === 'external-supplier' && !model.nameplateFile) { %>
  <div class="message message-inline message-warning">
    <p><%- t('FORM:edit:comment:nameplate') %></p>
  </div>
  <% } %>
  <div class="form-group">
    <label for="<%- idPrefix %>-comment" class="control-label"><%- t('PROPERTY:comment') %></label>
    <textarea id="<%- idPrefix %>-comment" class="form-control" name="comment" rows="3"></textarea>
  </div>
</div>
