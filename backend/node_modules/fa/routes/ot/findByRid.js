// Part of <https://miracle.systems/p/walkner-fa> licensed under <CC BY-NC-SA 4.0>

'use strict';

module.exports = (app, {FaOt}, req, res, next) =>
{
  let noProperty = 'documentNo';

  if (/^POT/.test(req.query.rid))
  {
    noProperty = 'protocolNo';
  }

  FaOt.findOne({[noProperty]: req.query.rid}, {_id: 1}).lean().exec((err, model) =>
  {
    if (err)
    {
      return next(err);
    }

    if (model)
    {
      return res.json(model._id);
    }

    return res.sendStatus(404);
  });
};
